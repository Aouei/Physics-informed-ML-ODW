{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Physics-informed ML ODW","text":"<p>Physics-informed Machine Learning for Optically-Derived Water (ODW) prediction.</p>"},{"location":"#overview","title":"Overview","text":"<p>This package provides pre-trained machine learning models for predicting Optically-Derived Water (ODW) values from satellite imagery. It integrates with sensingpy for image processing workflows.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Pre-trained Models: Ready-to-use ML pipelines for ODW prediction</li> <li>Multiple Model Types: <ul> <li><code>ML</code>: Standard Machine Learning model (MLP)</li> <li><code>CS_ML</code>: Caballero &amp; Stumpf Machine Learning model</li> </ul> </li> <li>Easy Integration: Works seamlessly with sensingpy Image objects</li> <li>2D Prediction: Generate full raster predictions from satellite imagery</li> </ul>"},{"location":"#installation","title":"Installation","text":"<pre><code>git clone https://github.com/Aouei/Physics-informed-ML-ODW.git\ncd Physics-informed-ML-ODW\npip install .\n</code></pre>"},{"location":"#dependencies","title":"Dependencies","text":"<ul> <li>Python &gt;= 3.11</li> <li>sensingpy</li> <li>numpy</li> <li>pandas</li> <li>scikit-learn == 1.7.2</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>from sensingpy import reader\nfrom physics_informed_ml_odw import predict_2d\n\n# Load satellite image\nimage = reader.open('path/to/image.tif')\n\n# Predict ODW values\nimage['ODW'] = predict_2d(image, model='ML')\n</code></pre>"},{"location":"#available-models","title":"Available Models","text":"Model Description File <code>ML</code> Machine Learning MLP model <code>ML__MLP.pkl</code> <code>CS_ML</code> Caballero &amp; Stumpf ML model <code>CS_ML__MLP.pkl</code>"},{"location":"#license","title":"License","text":"<p>This project is open source. See the repository for license details.</p>"},{"location":"api/","title":"API Reference","text":"<p>This page provides detailed documentation for all public functions in the <code>physics_informed_ml_odw</code> package.</p>"},{"location":"api/#module-physics_informed_ml_odw","title":"Module: physics_informed_ml_odw","text":""},{"location":"api/#physics_informed_ml_odw.predict.predict_2d","title":"<code>predict_2d(image, model='ML')</code>","text":"<p>Predict ODW values for a 2D image using a pre-trained model.</p> <p>Parameters:</p> Name Type Description Default <code>image</code> <code>Image</code> <p>The input image from sensingpy.</p> required <code>model</code> <code>Literal['ML', 'CS_ML']</code> <p>The model type to use for prediction: - \"ML\": Machine Learning model - \"CS_ML\": Caballero&amp;Stumpf Machine Learning model</p> <code>\"ML\"</code> <p>Returns:</p> Type Description <code>ndarray</code> <p>2D array with predicted ODW values.</p> Source code in <code>src\\physics_informed_ml_odw\\predict.py</code> <pre><code>def predict_2d(image: Image, model: Literal[\"ML\", \"CS_ML\"] = \"ML\") -&gt; np.ndarray:\n    \"\"\"Predict ODW values for a 2D image using a pre-trained model.\n\n    Parameters\n    ----------\n    image : Image\n        The input image from sensingpy.\n    model : Literal[\"ML\", \"CS_ML\"], default=\"ML\"\n        The model type to use for prediction:\n        - \"ML\": Machine Learning model\n        - \"CS_ML\": Caballero&amp;Stumpf Machine Learning model\n\n    Returns\n    -------\n    np.ndarray\n        2D array with predicted ODW values.\n    \"\"\"\n    pipeline = load_model(model)\n\n    X = pd.DataFrame({band: image.select(band).ravel() for band in pipeline.feature_names_in_}).dropna()\n\n    ODW = np.full(shape=(image.height, image.width), fill_value=np.nan, dtype=X.dtypes.iloc[0]).ravel()\n    ODW[X.index] = pipeline.predict(X)\n    ODW = ODW.reshape((image.height, image.width))\n\n    return ODW\n</code></pre>"},{"location":"api/#physics_informed_ml_odw.predict.load_model","title":"<code>load_model(model)</code>","text":"<p>Load a pre-trained model from the package resources.</p> <p>Parameters:</p> Name Type Description Default <code>model</code> <code>Literal['ML', 'CS_ML']</code> <p>The model type to load.</p> required <p>Returns:</p> Type Description <code>Pipeline</code> <p>The loaded scikit-learn pipeline.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If the model type is not recognized.</p> Source code in <code>src\\physics_informed_ml_odw\\predict.py</code> <pre><code>def load_model(model: Literal[\"ML\", \"CS_ML\"]) -&gt; Pipeline:\n    \"\"\"Load a pre-trained model from the package resources.\n\n    Parameters\n    ----------\n    model : Literal[\"ML\", \"CS_ML\"]\n        The model type to load.\n\n    Returns\n    -------\n    Pipeline\n        The loaded scikit-learn pipeline.\n\n    Raises\n    ------\n    ValueError\n        If the model type is not recognized.\n    \"\"\"\n    if model not in MODEL_FILES:\n        raise ValueError(f\"Model must be one of {list(MODEL_FILES.keys())}, got '{model}'\")\n\n    model_filename = MODEL_FILES[model]\n    with resources.files(\"physics_informed_ml_odw.models\").joinpath(model_filename).open(\"rb\") as f:\n        return joblib.load(f)\n</code></pre>"},{"location":"api/#functions","title":"Functions","text":""},{"location":"api/#predict_2d","title":"predict_2d","text":"<pre><code>predict_2d(image: Image, model: Literal[\"ML\", \"CS_ML\"] = \"ML\") -&gt; np.ndarray\n</code></pre> <p>Predict ODW values for a 2D image using a pre-trained model.</p> <p>Parameters</p> Name Type Default Description <code>image</code> <code>Image</code> required The input image from sensingpy <code>model</code> <code>Literal[\"ML\", \"CS_ML\"]</code> <code>\"ML\"</code> The model type to use for prediction <p>Returns</p> Type Description <code>np.ndarray</code> 2D array with predicted ODW values <p>Model Options</p> <ul> <li><code>\"ML\"</code>: Standard Machine Learning model</li> <li><code>\"CS_ML\"</code>: Caballero &amp; Stumpf Machine Learning model</li> </ul> <p>Example</p> <pre><code>from sensingpy import reader\nfrom physics_informed_ml_odw import predict_2d\n\nimage = reader.open('satellite_image.tif')\nodw_prediction = predict_2d(image, model='ML')\n</code></pre>"},{"location":"api/#load_model","title":"load_model","text":"<pre><code>load_model(model: Literal[\"ML\", \"CS_ML\"]) -&gt; Pipeline\n</code></pre> <p>Load a pre-trained model from the package resources.</p> <p>Parameters</p> Name Type Default Description <code>model</code> <code>Literal[\"ML\", \"CS_ML\"]</code> required The model type to load <p>Returns</p> Type Description <code>Pipeline</code> The loaded scikit-learn pipeline <p>Raises</p> Exception Description <code>ValueError</code> If the model type is not recognized <p>Example</p> <pre><code>from physics_informed_ml_odw import load_model\n\n# Load the ML model pipeline\npipeline = load_model('ML')\n\n# Access model components\nprint(pipeline.feature_names_in_)\n</code></pre>"},{"location":"api/#constants","title":"Constants","text":""},{"location":"api/#model_files","title":"MODEL_FILES","text":"<p>Dictionary mapping model names to their corresponding pickle files.</p> <pre><code>MODEL_FILES = {\n    \"ML\": \"ML__MLP.pkl\",\n    \"CS_ML\": \"CS_ML__MLP.pkl\",\n}\n</code></pre>"},{"location":"examples/","title":"Examples","text":"<p>This page provides practical examples for using the <code>physics_informed_ml_odw</code> package.</p>"},{"location":"examples/#basic-usage","title":"Basic Usage","text":""},{"location":"examples/#predicting-odw-from-a-satellite-image","title":"Predicting ODW from a Satellite Image","text":"<pre><code>from sensingpy import reader\nfrom physics_informed_ml_odw import predict_2d\n\n# Load your satellite image\nimage = reader.open('path/to/satellite_image.tif')\n\n# Predict ODW using the default ML model\nodw = predict_2d(image, model='ML')\n</code></pre>"},{"location":"examples/#comparing-models","title":"Comparing Models","text":""},{"location":"examples/#using-both-ml-and-cs_ml-models","title":"Using Both ML and CS_ML Models","text":"<p>This example demonstrates how to compare predictions from both available models.</p> <pre><code>from sensingpy import reader, plot\nfrom physics_informed_ml_odw import predict_2d\n\n# Load the satellite image\nimage = reader.open('data/formosa_2018.tif')\n\n# Predict using both models\nimage['ODW_ML'] = predict_2d(image, 'ML')\nimage['ODW_CS_ML'] = predict_2d(image, 'CS_ML')\n</code></pre>"},{"location":"examples/#visualization","title":"Visualization","text":""},{"location":"examples/#creating-a-comparison-plot","title":"Creating a Comparison Plot","text":"<p>Visualize the original image alongside ODW predictions using sensingpy's plotting utilities.</p> <pre><code>from sensingpy import reader, plot\nfrom physics_informed_ml_odw import predict_2d\n\n# Load image and generate predictions\nimage = reader.open('data/formosa_2018.tif')\nimage['ODW_ML'] = predict_2d(image, 'ML')\nimage['ODW_CS_ML'] = predict_2d(image, 'CS_ML')\n\n# Create a figure with 3 subplots\nfig, axs = plot.get_geofigure(image.crs, 1, 3, figsize=(6 * 3, 6))\n\n# Plot true color RGB composite\nplot.plot_rgb(image, 'Rrs_B4', 'Rrs_B3', 'Rrs_B2', axs[0], brightness=30)\n\n# Plot ODW predictions\nplot.plot_band(image, 'ODW_ML', axs[1])\nplot.plot_band(image, 'ODW_CS_ML', axs[2])\n\n# Add titles\naxs[0].set_title('True Color')\naxs[1].set_title('ODW ML')\naxs[2].set_title('ODW CS + ML')\n</code></pre> <p></p>"},{"location":"examples/#working-with-models-directly","title":"Working with Models Directly","text":""},{"location":"examples/#loading-and-inspecting-a-model","title":"Loading and Inspecting a Model","text":"<pre><code>from physics_informed_ml_odw import load_model\n\n# Load the ML model\npipeline = load_model('ML')\n\n# Inspect the model's expected features\nprint(\"Expected features:\", pipeline.feature_names_in_)\n\n# Access pipeline steps\nfor name, step in pipeline.steps:\n    print(f\"Step: {name}, Type: {type(step).__name__}\")\n</code></pre>"},{"location":"examples/#custom-predictions-with-loaded-model","title":"Custom Predictions with Loaded Model","text":"<pre><code>import pandas as pd\nimport numpy as np\nfrom physics_informed_ml_odw import load_model\n\n# Load model\npipeline = load_model('CS_ML')\n\n# Prepare your own data\ndata = pd.DataFrame({\n    'Rrs_B1': [...],\n    'Rrs_B2': [...],\n    'Rrs_B3': [...],\n    'Rrs_B4': [...],\n    # Include all required bands\n})\n\n# Make predictions\npredictions = pipeline.predict(data)\n</code></pre>"},{"location":"examples/#error-handling","title":"Error Handling","text":""},{"location":"examples/#handling-invalid-model-names","title":"Handling Invalid Model Names","text":"<pre><code>from physics_informed_ml_odw import load_model\n\ntry:\n    model = load_model('invalid_model')\nexcept ValueError as e:\n    print(f\"Error: {e}\")\n    # Output: Error: Model must be one of ['ML', 'CS_ML'], got 'invalid_model'\n</code></pre>"},{"location":"examples/#integration-with-workflows","title":"Integration with Workflows","text":""},{"location":"examples/#batch-processing-multiple-images","title":"Batch Processing Multiple Images","text":"<pre><code>from pathlib import Path\nfrom sensingpy import reader\nfrom physics_informed_ml_odw import predict_2d\nimport numpy as np\n\n# Directory containing satellite images\nimage_dir = Path('data/images/')\n\n# Process all GeoTIFF files\nfor image_path in image_dir.glob('*.tif'):\n    print(f\"Processing: {image_path.name}\")\n\n    # Load and predict\n    image = reader.open(str(image_path))\n    odw = predict_2d(image, model='ML')\n\n    # Save results\n    output_path = image_path.with_suffix('.odw.npy')\n    np.save(output_path, odw)\n\n    print(f\"Saved: {output_path.name}\")\n</code></pre>"}]}